@using Newtonsoft.Json;
@using Microsoft.AspNetCore.Http;
@inject IHttpContextAccessor Accessor;

@{
    ViewData["Title"] = "TeamDetail";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<section class="MainSecOff" id="secTeamDetails">
    <div class="container-fluid">
        <div class="row">
            <div class="col-12 col-md-12 col-lg-12">
                <div>
                    <div class="ShowSec">
                        <div class="">
                            <nav  aria-label="breadcrumb">
                                <ol class="breadcrumb">
                                    <li class="breadcrumb-item "><a href="/Teams/Teams" class="BrdCrmTxt">Teams</a></li>
                                    <li class="breadcrumb-item active BrdCrmSubTxt" aria-current="page">Detail</li>
                                </ol>
                            </nav>
                        </div>
                        <div>
                         <a href="/Teams/ContestantsList?teamID=@ViewBag.team.TeamID" style="text-decoration:none;">
                                <button type="button" class="AddContestantsBtn">Manage</button>
                         </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="PageBrdr"></div>
        <div class="row">
            <div class="col-12 col-md-12 col-lg-12">
                <div class="ShowDetHdrBx" style="margin-bottom:30px;">

                    <div class="d-flex DashResp3">
                        <div>
                            <div class="ShowDetHdrTxt">Team Name</div>
                            <div class="ShowDetHdrTxt1">@ViewBag.team.TeamName</div>
                        </div>
                        <div class="d-flex DashResp3">

                            <div>
                                <div class="ShowDetHdrTxt">Show Name</div>
                                <div class="ShowDetHdrTxt1">@ViewBag.team.ShowName</div>
                            </div>

                            <div>
                                <div class="ShowDetHdrTxt">Date</div>
                                <div class="ShowDetHdrTxt1">@ViewBag.team.CreatedDate.ToString("dd MMM,yyyy")</div>
                            </div>

                        </div>
                    </div>

                    <div class="ShowDetEditBx d-none">
                        <img src="~/Images/ShowDetEditIc.svg" class="ShowDetEditIc" />
                    </div>

                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-12 col-md-12 col-lg-12">
                <div class="BrdCrmSubTxt">
                    Contestants List
                </div>
                <div>
                    <div class="table-responsive" id="divContestanttbl">
                        
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

@*modal eliminated start*@

<div class="modal fade" id="EliminatedModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog EditMdlSec ShowModBx" role="document" id="divEliminatedhtml">

    </div>
</div>
@*modal eliminated end*@


@*modal eliminated start*@

<div class="modal fade" id="VoteInModal" tabindex="-1" role="dialog" aria-labelledby="exampleVoteInModalLabel" aria-hidden="true">
    <div class="modal-dialog EditMdlSec ShowModBx" role="document" id="divVoteInhtml">

    </div>
</div>
@*modal eliminated end*@


@section scripts
    {

    <script>
        $(document).ready(function () {
            $('#Teams').addClass('activeHead');
            $('#ActiveTitle4').addClass('activeSnd');
            GetContenstantList();

            setTimeout(LayoutToggle(), 5000);

        });

        table = $('#TeamDetailTbl').DataTable({
            "dom": '<"top"fl><"position-relative"tr><"bottom"ip><"clear">',
            "bLengthChange": true,
            "pageLength": 10,
            "lengthChange": false,
            "processing": false,
            "searching": false,
            "destroy": true,
            "paging": true,
            "info": true,
            "bSort": false,
            "scrollX": false,
            "language": {
                "loadingRecords": "Loading...",
                "processing": "Processing...",
                "paginate": {
                    "previous": "<",
                    "next": ">"
                },
            },
        });


       function LayoutToggle(fval)        
       {           
            var btntoggleVal=parseInt(@Accessor.HttpContext.Session.GetInt32("ToggleValue"));
        
            if(fval !='' && fval != undefined){
                btntoggleVal=fval;
            }
           
            if(btntoggleVal == 1){
            var element5 = document.getElementById('secTeamDetails');           
            var elemen = document.getElementById('LayoutSdBar1');            
            element5.classList.toggle('MainSec');          
            elemen.classList.toggle('d-none');     
            }
        }

    function GetContenstantList(){
            
             $.ajax({
                 type: 'GET',
                 url: "/teams/GetContenstantListTable?teamID="+@ViewBag.team.TeamID,
                 data: {},
                 success: function (data, textStatus, jqXHR) {       
                     
                    $('#divContestanttbl').html('');
                    $('#divContestanttbl').html(data);
                 }
             });
        }

        
        function GetContenstantEliminate(id,ContestantID){
          
             $.ajax({
                 type: 'GET',
                 url: "/teams/GetEliminatedContestant?teamContestantID="+id+"&contestantID="+ContestantID,
                 data: {},
                 success: function (data, textStatus, jqXHR) {       
                  
                    $('#divEliminatedhtml').html('');
                    $('#divEliminatedhtml').html(data);
                    $('#EliminatedModal').modal("show");
                 }
             });
        }
        
      function GetContenstantVoteIn(id,ContestantID){
          
             $.ajax({
                 type: 'GET',
                 url: "/teams/GetContenstantVoteIn?teamContestantID="+id+"&contestantID="+ContestantID,
                 data: {},
                 success: function (data, textStatus, jqXHR) {       
                  
                    $('#divVoteInhtml').html('');
                    $('#divVoteInhtml').html(data);
                    $('#VoteInModal').modal("show");
                 }
             });
        }
       
        function UpdateTeamContestantVoteIn(id){
              $.ajax({
                 type: 'GET',
                 url: "/teams/VoteInContestant?teamContestantID="+id,
                 data: {},
                 success: function (data, textStatus, jqXHR) {       
                     GetContenstantList();
                     $('#VoteInModal').modal("hide");
                 }
             });
        }

        function UpdateTeamContestant(id){
              $.ajax({
                 type: 'GET',
                 url: "/teams/VoteOutContestant?teamContestantID="+id,
                 data: {},
                 success: function (data, textStatus, jqXHR) {       
                     GetContenstantList();
                     $('#EliminatedModal').modal("hide");
                 }
             });
        }
    </script>
    }

